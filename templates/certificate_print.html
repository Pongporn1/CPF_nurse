<!doctype html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Medical_Certificate</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: "Sarabun", sans-serif;
        font-size: 12pt;
        line-height: 1.78;
        background: white;
        padding: 0;
      }

      @page {
        size: A4;
        margin: 3mm 5mm;
      }

      .certificate-container {
        width: 100%;
        border: 2px solid #000;
        padding: 11px;
      }

      .header-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 4px;
        font-size: 12pt;
      }

      .cert-title {
        text-align: center;
        font-size: 17pt;
        font-weight: 700;
        margin: 5px 0 7px;
      }

      .section-header {
        font-weight: 700;
        font-size: 13pt;
        margin: 10px 0 5px;
        display: inline-block;
        background: #000;
        color: #fff;
        padding: 1px 8px;
      }

      .info-line {
        margin-bottom: 3px;
        line-height: 1.78;
        font-size: 12pt;
      }

      .underline {
        display: inline-block;
        padding: 0 3px;
      }

      .underline.has-underline {
        border-bottom: 1px dotted #000;
        min-width: 100px;
      }

      .id-boxes {
        display: inline-flex;
        gap: 3px;
        margin: 0 3px;
        align-items: center;
      }

      .id-box {
        width: 19px;
        height: 24px;
        border: 1px solid #000;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-size: 11pt;
        font-weight: 700;
      }

      .id-separator {
        display: inline-block;
        margin: 0 1px;
      }

      .checkbox {
        width: 12px;
        height: 12px;
        border: 1px solid #000;
        display: inline-block;
        margin: 0 2px;
        vertical-align: middle;
        position: relative;
      }

      .checkbox.checked::before {
        content: "‚úì";
        font-size: 10pt;
        font-weight: 700;
        position: absolute;
        left: 0;
        top: -3px;
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .two-col {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 8px;
        margin: 3px 0;
      }

      .health-item {
        margin-bottom: 3px;
        font-size: 12pt;
      }

      .signature-area {
        text-align: right;
        margin-top: 4px;
        font-size: 12pt;
      }

      .note-section {
        margin-top: 5px;
        font-size: 10pt;
        line-height: 1.3;
      }

      .note-title {
        font-weight: 700;
        margin-bottom: 1px;
      }

      .long-text {
        text-indent: 2em;
        margin: 4px 0;
        line-height: 1.38;
        font-size: 11pt;
      }

      .disease-list {
        margin-left: 2em;
        line-height: 1.38;
        font-size: 11pt;
      }

      .disease-list div {
        margin-bottom: 2px;
      }

      @media print {
        body {
          padding: 0;
          zoom: 0.87;
          -webkit-print-color-adjust: exact;
          print-color-adjust: exact;
          color-adjust: exact;
        }

        .no-print {
          display: none !important;
        }

        @page {
          size: A4 portrait;
          margin: 3mm 5mm;
        }

        .certificate-container {
          page-break-inside: avoid;
        }

        .section-header {
          -webkit-print-color-adjust: exact;
          print-color-adjust: exact;
          color-adjust: exact;
        }
      }

      .action-buttons {
        text-align: center;
        margin: 12px 0;
      }

      .btn {
        padding: 8px 20px;
        font-size: 13pt;
        font-weight: 600;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        text-decoration: none;
        display: inline-block;
        margin: 0 5px;
      }

      .btn-print {
        background: #1e88e5;
        color: white;
      }

      .btn-back {
        background: #28a745;
        color: white;
      }
    </style>
  </head>
  <body>
    <div class="certificate-container">
      <!-- ‡∏õ‡∏∏‡πà‡∏° (‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå) -->
      <div class="action-buttons no-print">
        <a href="/medical_certificate" class="btn btn-back">‚¨Ö ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</a>
        <button class="btn btn-print" onclick="window.print()">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå</button>
      </div>

      <!-- ‡∏´‡∏±‡∏ß -->
      <div class="header-row">
        <div>
          ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà
          <span class="underline" style="min-width: 100px" id="cert-number-left"
            >__________</span
          >
        </div>
        <div>
          ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà
          <span
            class="underline"
            style="min-width: 100px"
            id="cert-number-right"
            >__________</span
          >
        </div>
      </div>

      <div class="cert-title">‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå</div>

      <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1 -->
      <div style="margin-bottom: 6px">
        <div style="margin-bottom: 3px">
          <span class="section-header">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1</span>
          <span style="font-weight: 600; font-size: 12pt; margin-left: 8px"
            >‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</span
          >
        </div>
        <div style="margin-top: 3px">
          <div class="info-line">
            <span>‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤ </span>
            <span
              class="underline"
              style="min-width: 250px; font-weight: 700"
              id="fullname"
              >‡∏û‡∏á‡∏®‡πå‡∏†‡∏£‡∏ì‡πå ‡∏™‡∏µ‡∏ó‡∏≠‡∏á</span
            >
          </div>

          <div class="info-line">
            <span>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà </span>
            <span class="underline" style="min-width: 520px" id="address"
              >‡∏ö.7 ‡∏´‡∏°‡∏π‡πà 7 ‡∏ï.‡∏ä‡∏ô‡∏ö‡∏ó ‡∏≠.‡∏ß‡∏≤‡∏õ‡∏µ‡∏õ‡∏ó‡∏∏‡∏° ‡∏à.‡∏°‡∏´‡∏≤‡∏™‡∏≤‡∏£‡∏Ñ‡∏≤‡∏°</span
            >
          </div>

          <div class="info-line">
            <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà (‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ) </span>
            <span
              class="underline"
              style="min-width: 400px"
              id="contact-address"
              >‡∏ö.7 ‡∏´‡∏°‡∏π‡πà 7 ‡∏ï.‡∏ä‡∏ô‡∏ö‡∏ó ‡∏≠.‡∏ß‡∏≤‡∏õ‡∏µ‡∏õ‡∏ó‡∏∏‡∏° ‡∏à.‡∏°‡∏´‡∏≤‡∏™‡∏≤‡∏£‡∏Ñ‡∏≤‡∏°</span
            >
          </div>

          <div class="info-line" style="text-align: center; margin: 6px 0">
            <span>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</span>
            <div class="id-boxes">
              <div class="id-box" id="id-1">1</div>
              <span class="id-separator">-</span>
              <div class="id-box" id="id-2">1</div>
              <div class="id-box" id="id-3">0</div>
              <div class="id-box" id="id-4">0</div>
              <div class="id-box" id="id-5">7</div>
              <span class="id-separator">-</span>
              <div class="id-box" id="id-6">0</div>
              <div class="id-box" id="id-7">3</div>
              <div class="id-box" id="id-8">5</div>
              <div class="id-box" id="id-9">5</div>
              <div class="id-box" id="id-10">3</div>
              <span class="id-separator">-</span>
              <div class="id-box" id="id-11">4</div>
              <div class="id-box" id="id-12">6</div>
              <span class="id-separator">-</span>
              <div class="id-box" id="id-13">9</div>
            </div>
          </div>

          <div class="info-line">
            <span>‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ</span>
          </div>

          <div class="two-col">
            <div>
              <div class="health-item">
                <div>1. ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß</div>
                <div style="margin-left: 12px">
                  <span class="checkbox" id="disease-no"></span> ‡πÑ‡∏°‡πà‡∏°‡∏µ
                  <span class="checkbox" id="disease-yes"></span> ‡∏°‡∏µ (‡∏£‡∏∞‡∏ö‡∏∏)
                  <span
                    class="underline"
                    style="min-width: 100px"
                    id="disease-detail"
                    >‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ</span
                  >
                </div>
              </div>

              <div class="health-item">
                <div>2. ‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏ ‡πÅ‡∏•‡∏∞ ‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î</div>
                <div style="margin-left: 12px">
                  <span class="checkbox" id="accident-no"></span> ‡πÑ‡∏°‡πà‡∏°‡∏µ
                  <span class="checkbox" id="accident-yes"></span> ‡∏°‡∏µ (‡∏£‡∏∞‡∏ö‡∏∏)
                  <span
                    class="underline"
                    style="min-width: 100px"
                    id="accident-detail"
                    >_______</span
                  >
                </div>
              </div>
            </div>

            <div>
              <div class="health-item">
                <div>3. ‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</div>
                <div style="margin-left: 12px">
                  <span class="checkbox" id="hospital-no"></span> ‡πÑ‡∏°‡πà‡∏°‡∏µ
                  <span class="checkbox" id="hospital-yes"></span> ‡∏°‡∏µ (‡∏£‡∏∞‡∏ö‡∏∏)
                  <span
                    class="underline"
                    style="min-width: 90px"
                    id="hospital-detail"
                    >_______</span
                  >
                </div>
              </div>

              <div class="health-item">
                <div>4. ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà</div>
                <div style="margin-left: 12px">
                  <span>‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç </span
                  ><span
                    class="underline"
                    style="min-width: 60px"
                    id="other-history"
                    >_______</span
                  >
                </div>
              </div>
            </div>
          </div>

          <div class="signature-area">
            <div style="margin-top: 3px">
              <span>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ </span>
              <span
                class="underline"
                style="min-width: 60px"
                id="requester-sign"
                >‡∏ó‡∏±‡∏®‡∏ô‡∏∞‡πÄ‡∏Å‡∏®</span
              >
              <span> ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà </span>
              <span class="underline" style="min-width: 20px" id="req-day"
                >20</span
              >
              <span> ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô </span>
              <span class="underline" style="min-width: 50px" id="req-month"
                >‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°</span
              >
              <span> ‡∏û.‡∏®. </span>
              <span class="underline" style="min-width: 35px" id="req-year"
                >2569</span
              >
            </div>
            <div style="font-size: 10pt; margin-top: 1px">
              ‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÉ‡∏ô‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô
              ‡πÉ‡∏´‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡∏â‡∏ö‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå
            </div>
          </div>
        </div>
      </div>

      <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2 -->
      <div style="margin-bottom: 6px">
        <div style="margin-bottom: 3px">
          <span class="section-header">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2</span>
          <span style="font-weight: 600; font-size: 12pt; margin-left: 8px"
            >‡∏Ç‡∏≠‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå</span
          >
        </div>
        <div style="margin-top: 3px">
          <div class="info-line">
            <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à </span>
            <span class="underline" style="min-width: 200px" id="hospital-name"
              >_________________</span
            >
            <span style="margin-left: 15px">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà </span>
            <span class="underline" style="min-width: 30px" id="exam-day"
              >___</span
            >
            <span> ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô </span>
            <span class="underline" style="min-width: 60px" id="exam-month"
              >________</span
            >
            <span> ‡∏û.‡∏®. </span>
            <span class="underline" style="min-width: 40px" id="exam-year"
              >____</span
            >
          </div>

          <div class="info-line">
            <span>(1) ‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤ ‡∏ô‡∏≤‡∏¢‡πÅ‡∏û‡∏ó‡∏¢‡πå/‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏´‡∏ç‡∏¥‡∏á </span>
            <span class="underline" style="min-width: 250px" id="doctor-name"
              >_________________________</span
            >
          </div>

          <div class="info-line" style="margin-left: 20px">
            <span>‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö</span>
            <span class="underline" style="min-width: 150px"
              >_______________</span
            >
            <span>‡∏™‡∏ñ‡∏≤‡∏ô</span>
          </div>

          <div class="info-line" style="margin-left: 20px">
            <span>‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û‡πÄ‡∏ß‡∏ä‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà </span>
            <span class="underline" style="min-width: 120px" id="license"
              >____________</span
            >
            <span>‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ä‡∏∑‡πà‡∏≠</span>
          </div>

          <div class="info-line">
            <span>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà </span>
            <span
              class="underline"
              style="min-width: 500px"
              id="hospital-address"
              >__________________________________________________</span
            >
          </div>

          <div class="info-line" style="margin-left: 20px">
            <span>‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏ô‡∏≤‡∏¢/‡∏ô‡∏≤‡∏á/‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß </span>
            <span class="underline" style="min-width: 250px" id="patient-name"
              >_________________________</span
            >
          </div>

          <div class="info-line">
            <span>‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤ </span>
            <span class="underline" style="min-width: 30px">___</span>
            <span> ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô </span>
            <span class="underline" style="min-width: 70px">________</span>
            <span> ‡∏û.‡∏®. </span>
            <span class="underline" style="min-width: 45px">____</span>
            <span> ‡∏°‡∏µ‡∏£‡∏≤‡∏¢</span>
          </div>

          <div class="info-line">
            <span>‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ</span>
          </div>

          <div class="info-line" style="margin-left: 20px">
            <span>‡∏ô‡πâ‡∏≥ </span>
            <span class="underline" style="min-width: 40px" id="weight"
              >____</span
            >
            <span> ‡∏Å‡∏Å. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á </span>
            <span class="underline" style="min-width: 40px" id="height"
              >____</span
            >
            <span> ‡πÄ‡∏ã‡∏ô‡∏ï‡∏¥‡πÄ‡∏°‡∏ï‡∏£ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï </span>
            <span class="underline" style="min-width: 60px" id="bp"
              >______</span
            >
            <span> ‡∏°‡∏°.‡∏õ‡∏£‡∏≠‡∏ó ‡∏ä‡∏µ‡∏û‡∏à‡∏£ </span>
            <span class="underline" style="min-width: 40px" id="pulse"
              >____</span
            >
            <span> ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</span>
          </div>

          <div class="info-line">
            <span>‡∏´‡∏ô‡∏±‡∏Å </span>
            <span class="underline" style="min-width: 70px">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á</span>
            <span> ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô </span>
            <span class="underline" style="min-width: 80px">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï</span>
            <span> ‡∏ä‡∏µ‡∏û‡∏à‡∏£ </span>
            <span class="underline" style="min-width: 60px">____</span>
            <span> ‡∏ô‡∏≤‡∏ó‡∏µ</span>
          </div>

          <div class="info-line">
            <span>‡∏ó‡∏µ‡πà‡∏•‡∏±‡∏Å‡∏©‡∏ì</span>
          </div>

          <div class="info-line" style="margin-left: 20px">
            <span>‡∏™‡∏†‡∏≤‡∏û‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå </span>
            <span class="checkbox" id="body-normal"></span> ‡∏õ‡∏Å‡∏ï‡∏¥
            <span class="checkbox" id="body-abnormal"></span> ‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥ (‡∏£‡∏∞‡∏ö‡∏∏)
          </div>

          <div class="long-text">
            ‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏ß‡πà‡∏≤ ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß
            ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏ó‡∏∏‡∏û‡∏û‡∏•‡∏†‡∏≤‡∏û‡∏à‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏Ñ‡∏à‡∏¥‡∏ï
            ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏¥‡∏ï‡∏ü‡∏±‡πà‡∏ô‡πÄ‡∏ü‡∏∑‡∏≠‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏≠‡πà‡∏≠‡∏ô ‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡πÉ‡∏´‡πâ‡πÇ‡∏ó‡∏©
            ‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏Ñ‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏£‡∏≤‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á
            ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏Ñ‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ
          </div>

          <div class="disease-list">
            <div>
              (1) ‡πÇ‡∏£‡∏Ñ‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠
              ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏á‡πÄ‡∏Å‡∏µ‡∏¢‡∏à‡πÅ‡∏Å‡πà‡∏™‡∏±‡∏á‡∏Ñ‡∏°
            </div>
            <div>(2) ‡∏ß‡∏±‡∏ì‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢</div>
            <div>(3) ‡πÇ‡∏£‡∏Ñ‡πÄ‡∏ó‡πâ‡∏≤‡∏ä‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏á‡πÄ‡∏Å‡∏µ‡∏¢‡∏à‡πÅ‡∏Å‡πà‡∏™‡∏±‡∏á‡∏Ñ‡∏°</div>
            <div>
              (4) ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
              <span
                class="underline"
                style="min-width: 200px"
                id="other-disease"
                >____________________</span
              >
              (‡πÇ‡∏£‡∏Ñ‡∏ó‡∏µ‡πà‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏£‡∏ì‡∏≤‡∏û‡∏¥‡πÄ‡∏à‡∏ï‡∏ô‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏°‡∏≤‡∏¢‡∏∑‡∏î‡∏¢‡∏≤‡∏ß)
            </div>
          </div>

          <div class="info-line">
            <span>(2) ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏ä‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏û‡∏ó‡∏¢‡πå </span>
            <span class="checkbox" id="work-ok"></span>
            ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏µ‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÑ‡∏î‡πâ
            <span class="checkbox" id="work-not-ok"></span>
            ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏µ‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÑ‡∏î‡πâ
          </div>

          <div class="signature-area" style="margin-top: 8px">
            <div>
              <span>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ </span>
              <span class="underline" style="min-width: 100px" id="doctor-sign"
                >__________________</span
              >
            </div>
            <div style="margin-top: 1px">‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢</div>
          </div>

          <div class="note-section">
            <div class="note-title">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</div>
            <div>
              (1)
              ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ã‡∏∂‡πà‡∏á‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏£‡∏±‡∏ö‡πÉ‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û‡πÄ‡∏ß‡∏ä‡∏Å‡∏£‡∏£‡∏°
            </div>
            <div>
              (2) ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÉ‡∏î
              ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏â‡∏ö‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ 1 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢ +
              ‡πÄ‡∏•‡∏Ç‡∏ô‡∏±‡∏î‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ 4/2561 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 19 ‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô 2561
            </div>
            <div>(3) ‡∏Ñ‡∏≥‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</div>
            <div>
              ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏°‡∏ï‡∏¥‡∏Ñ‡∏ì‡∏∞‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡∏™‡∏†‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà
              4/2561 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 19 ‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô 2561
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      function convertToBuddhistYear(dateString) {
        if (!dateString) return { day: "", month: "", year: "" };
        const date = new Date(dateString);
        const months = [
          "‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°",
          "‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå",
          "‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°",
          "‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô",
          "‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°",
          "‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô",
          "‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°",
          "‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°",
          "‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô",
          "‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°",
          "‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô",
          "‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°",
        ];
        return {
          day: date.getDate().toString(),
          month: months[date.getMonth()],
          year: (date.getFullYear() + 543).toString(),
        };
      }

      function fillCitizenId(citizenId) {
        if (!citizenId) return;
        const digits = citizenId.replace(/[^0-9]/g, "").split("");
        for (let i = 1; i <= 13 && i <= digits.length; i++) {
          const box = document.getElementById(`id-${i}`);
          if (box) box.textContent = digits[i - 1] || "_";
        }
      }

      function checkBox(id) {
        const box = document.getElementById(id);
        if (box) box.classList.add("checked");
      }

      function loadData() {
        const urlParams = new URLSearchParams(window.location.search);
        const certId = urlParams.get("id");

        if (certId) {
          fetch(`/api/medical_certificate/${certId}`)
            .then((res) => res.json())
            .then((data) => {
              if (data.success) {
                populateForm(data.record);
              }
            })
            .catch((err) => console.error("Error:", err));
        } else {
          const tempData = localStorage.getItem("tempCertificateData");
          if (tempData) {
            populateForm(JSON.parse(tempData));
            localStorage.removeItem("tempCertificateData");
          }
        }
      }

      function setFieldValue(id, value, defaultBlank = "") {
        const el = document.getElementById(id);
        if (!el) return;

        // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô underscores
        if (value && !value.match(/^_+$/)) {
          el.textContent = value;
          if (el.classList.contains("underline")) {
            el.classList.remove("has-underline");
          }
        } else {
          el.textContent = defaultBlank;
          if (el.classList.contains("underline")) {
            el.classList.add("has-underline");
          }
        }
      }

      function populateForm(data) {
        setFieldValue("cert-number-left", data.cert_number);
        setFieldValue("cert-number-right", data.cert_number);
        setFieldValue("fullname", data.fullname);
        setFieldValue("address", data.address);
        setFieldValue("contact-address", data.address);

        fillCitizenId(data.citizenId);

        if (data.disease === "‡πÑ‡∏°‡πà‡∏°‡∏µ") checkBox("disease-no");
        else if (data.disease === "‡∏°‡∏µ") {
          checkBox("disease-yes");
          setFieldValue("disease-detail", data.disease_detail);
        }

        if (data.accident === "‡πÑ‡∏°‡πà‡∏°‡∏µ") checkBox("accident-no");
        else if (data.accident === "‡∏°‡∏µ") {
          checkBox("accident-yes");
          setFieldValue("accident-detail", data.accident_detail);
        }

        if (data.hospital === "‡πÑ‡∏°‡πà‡∏°‡∏µ") checkBox("hospital-no");
        else if (data.hospital === "‡∏°‡∏µ") {
          checkBox("hospital-yes");
          setFieldValue("hospital-detail", data.hospital_detail);
        }

        setFieldValue("other-history", data.other_history);

        const reqDate = convertToBuddhistYear(data.requester_date);
        setFieldValue("req-day", reqDate.day);
        setFieldValue("req-month", reqDate.month);
        setFieldValue("req-year", reqDate.year);
        setFieldValue("requester-sign", data.requester_sign);

        setFieldValue("hospital-name", data.hospital_name);

        const examDate = convertToBuddhistYear(data.exam_date);
        setFieldValue("exam-day", examDate.day);
        setFieldValue("exam-month", examDate.month);
        setFieldValue("exam-year", examDate.year);

        setFieldValue("doctor-name", data.doctor_name);
        setFieldValue("license", data.license);
        setFieldValue("hospital-address", data.hospital_address);
        setFieldValue("patient-name", data.fullname);

        setFieldValue("weight", data.weight);
        setFieldValue("height", data.height);
        setFieldValue("bp", data.bp);
        setFieldValue("pulse", data.pulse);

        if (data.body_status === "‡∏õ‡∏Å‡∏ï‡∏¥") checkBox("body-normal");
        else if (data.body_status === "‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥") checkBox("body-abnormal");

        setFieldValue("other-disease", data.other_disease);

        if (data.work_result === "‡πÑ‡∏î‡πâ") checkBox("work-ok");
        else if (data.work_result === "‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ") checkBox("work-not-ok");

        setFieldValue("doctor-sign", data.doctor_sign);
      }

      window.addEventListener("DOMContentLoaded", loadData);
    </script>
  </body>
</html>
